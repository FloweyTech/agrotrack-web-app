<div class="report-list-container">
  <div class="header-section">
    <h2>Reportes</h2>
    <button mat-raised-button class="refresh-button" (click)="reload()">
      Actualizar
    </button>
  </div>

  <div class="filters">
    <label for="orgFilter">Filtrar por Organización:</label>
    <select id="orgFilter" (change)="filterByOrganization($event)">
      <option value="">Todas las organizaciones</option>
      <option *ngFor="let org of organizations" [value]="org">
        {{ org }}
      </option>
    </select>
  </div>

  <p *ngIf="store.loading()" class="loading-text">Cargando reportes...</p>

  <table *ngIf="!store.loading()" mat-table [dataSource]="filteredReports" class="mat-elevation-z2">
    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef>ID</th>
      <td mat-cell *matCellDef="let r">{{ r.id }}</td>
    </ng-container>

    <ng-container matColumnDef="organizationName">
      <th mat-header-cell *matHeaderCellDef>Organización</th>
      <td mat-cell *matCellDef="let r">{{ r.organizationName }}</td>
    </ng-container>

    <ng-container matColumnDef="type">
      <th mat-header-cell *matHeaderCellDef>Tipo</th>
      <td mat-cell *matCellDef="let r">{{ r.type }}</td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Estado</th>
      <td mat-cell *matCellDef="let r">{{ r.status }}</td>
    </ng-container>

    <ng-container matColumnDef="period">
      <th mat-header-cell *matHeaderCellDef>Periodo</th>
      <td mat-cell *matCellDef="let r">
        {{ r.periodStart | date: 'dd/MM/yyyy' }} - {{ r.periodEnd | date: 'dd/MM/yyyy' }}
      </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Acciones</th>
      <td mat-cell *matCellDef="let r">
        <button mat-raised-button color="primary" (click)="generate(r)">
          Generar
        </button>
        <a mat-raised-button color="accent" [routerLink]="[r.id]">
          Ver detalle
        </a>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
</div>
